import{_ as n}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as s,c as a,f as p}from"./app-VKLC1A-x.js";const t={},e=p(`<h1 id="excel操作" tabindex="-1"><a class="header-anchor" href="#excel操作" aria-hidden="true">#</a> Excel操作</h1><h2 id="excel读取" tabindex="-1"><a class="header-anchor" href="#excel读取" aria-hidden="true">#</a> Excel读取</h2><p><strong>准备</strong>：安装Python包：<code>pip install openpyxl</code></p><p>openpyxl参数文档：https://openpyxl.readthedocs.io/en/stable/</p><p><code>workbook</code>：工作簿</p><p><code>worksheet</code>：表单</p><p><code>row</code>、<code>column</code>、<code>cell</code>：行、列、单元格</p><ul><li><p><strong>Excel文件读取</strong></p><p>使用<code>load_workbook()</code>方法读取Excel文件，获取<code>workbook</code>对象</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> openpyxl
wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span><span class="token string">&#39;example.xlsx&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>Excel表单读取</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>wb<span class="token punctuation">.</span>sheetnames<span class="token punctuation">)</span>  <span class="token comment"># 获取工作簿中所有表单的名字，返回一个列表</span>
<span class="token keyword">for</span> sheet <span class="token keyword">in</span> wb<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>title<span class="token punctuation">)</span>  <span class="token comment"># 遍历获取表单的名字</span>
mySheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">&#39;mySheet&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 创建表单，表单名为：mySheet</span>
sheet3 <span class="token operator">=</span> wb<span class="token punctuation">.</span>get_sheet_by_name<span class="token punctuation">(</span><span class="token string">&#39;Sheet3&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 获取表单</span>
sheet4 <span class="token operator">=</span> wb<span class="token punctuation">[</span><span class="token string">&#39;mySheet&#39;</span><span class="token punctuation">]</span>  <span class="token comment"># 获取表单</span>
active_sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>active  <span class="token comment"># 获取活跃表单</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>获取单元格</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>c <span class="token operator">=</span> active_sheet<span class="token punctuation">[</span><span class="token string">&#39;C2&#39;</span><span class="token punctuation">]</span>  <span class="token comment"># 获取C2单元格</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>row<span class="token punctuation">)</span>  <span class="token comment"># 获取单元格所在的行</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>column<span class="token punctuation">)</span>  <span class="token comment"># 获取单元格所在的列</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>value<span class="token punctuation">)</span>  <span class="token comment"># 获取单元格中的内容</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>coordinate<span class="token punctuation">)</span>  <span class="token comment"># 获取单元格所在的行和列</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>active_sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 获取1行2列的单元格</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>获取表格中的行和列</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>colA <span class="token operator">=</span> active_sheet<span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">]</span>  <span class="token comment"># 获取列，返回一个元组</span>
row2 <span class="token operator">=</span> active_sheet<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>  <span class="token comment"># 获取行，返回一个元组</span>
col_range <span class="token operator">=</span> active_sheet<span class="token punctuation">[</span><span class="token string">&#39;A:B&#39;</span><span class="token punctuation">]</span>  <span class="token comment"># 获取多列，返回一个元组，每列单元格组成小元组</span>
row_range <span class="token operator">=</span> active_sheet<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>  <span class="token comment"># 获取多行，返回一个元组，每行单元格组成小元组</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> active_sheet<span class="token punctuation">.</span>iter_rows<span class="token punctuation">(</span>min_row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>max_row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>max_col<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span>
cell_range <span class="token operator">=</span> active_sheet<span class="token punctuation">[</span><span class="token string">&#39;A1:C4&#39;</span><span class="token punctuation">]</span>  <span class="token comment"># 获取A1到C4的单元格，返回一个元组，每行单元格组成小元组</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>active_sheet<span class="token punctuation">.</span>max_row<span class="token punctuation">)</span>  <span class="token comment"># 获取表格的总行数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>active_sheet<span class="token punctuation">.</span>max_column<span class="token punctuation">)</span>  <span class="token comment"># 获取表格的总列数</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>其他</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>utils <span class="token keyword">import</span> get_column_letter<span class="token punctuation">,</span> column_index_from_string
<span class="token keyword">print</span><span class="token punctuation">(</span>get_column_letter<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 将数字转换为Excel中表示列数的字母</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>column_index_from_string<span class="token punctuation">(</span><span class="token string">&#39;KUI&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 将字母转换为Excel中表示列数的数字</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="excel的写入" tabindex="-1"><a class="header-anchor" href="#excel的写入" aria-hidden="true">#</a> Excel的写入</h2><p>使用<code>openpyxl.Workbook()</code>创建一个工作簿，使用<code>wb.save()</code>保存工作簿</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 创建一个工作簿</span>
wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;example_write.xlsx&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 保存工作簿，生成Excel文件</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>对Excel文件的修改最终也需要调用<code>save()</code>方法进行保存，同时保存时最好存储为另一个文件名，防止程序出错导致原数据丢失</p><ul><li><p><strong>表单操作</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>sheet<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;HappySheet&#39;</span>  <span class="token comment"># 更改表单的名字</span>
wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">&#39;mySheet&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 创建表单，仅指定名字将会在最后位置创建表单</span>
wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>title<span class="token operator">=</span><span class="token string">&#39;First Sheet&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 创建表单，同时指定位置</span>
wb<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>wb<span class="token punctuation">[</span><span class="token string">&#39;mySheet&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 删除表单，不能直接指定表单名，需要先获取表单再删除</span>
wb<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>wb<span class="token punctuation">.</span>get_sheet_by_name<span class="token punctuation">(</span><span class="token string">&#39;HappySheet&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 删除表单</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>单元格操作</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> openpyxl
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>utils <span class="token keyword">import</span> get_column_letter

wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 创建工作簿</span>
sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>active  <span class="token comment"># 获取表单</span>

sheet<span class="token punctuation">[</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;Hello Python&#39;</span>  <span class="token comment"># 向一个单元格中写入数据</span>
sheet<span class="token punctuation">[</span><span class="token string">&#39;C9&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;Hello Python&#39;</span>  <span class="token comment"># 向一个单元格中写入数据</span>

sheet1 <span class="token operator">=</span> wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">&#39;range names&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 创建表单</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sheet1<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 向一行单元格中写入多列数据</span>

sheet2 <span class="token operator">=</span> wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">&#39;List&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 创建表单</span>
rows <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&#39;Number&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Batch1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Batch2&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">234</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> rows<span class="token punctuation">:</span>
    sheet2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>  <span class="token comment"># 向多行单元格中写入多列数据</span>

sheet3 <span class="token operator">=</span> wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">&#39;Data&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        sheet3<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>column<span class="token operator">=</span>col<span class="token punctuation">,</span> row<span class="token operator">=</span>row<span class="token punctuation">,</span> value<span class="token operator">=</span>get_column_letter<span class="token punctuation">(</span>col<span class="token punctuation">)</span><span class="token punctuation">)</span>

wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;example_cell.xlsx&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 保存工作簿，生成Excel文件</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="excel样式设置" tabindex="-1"><a class="header-anchor" href="#excel样式设置" aria-hidden="true">#</a> Excel样式设置</h2><p>参考文档：https://openpyxl.readthedocs.io/en/stable/styles.html#cell-styles-and-named-styles</p><ul><li><p><strong>字体</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>styles <span class="token keyword">import</span> Font
italic24Font <span class="token operator">=</span> Font<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">,</span> italic<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
ws<span class="token punctuation">[</span><span class="token string">&#39;B3&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>font <span class="token operator">=</span> italic24Font
ws<span class="token punctuation">[</span><span class="token string">&#39;B3&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;24pt Italic&#39;</span>
boldRedFont <span class="token operator">=</span> Font<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&#39;Times New Roman&#39;</span><span class="token punctuation">,</span> bold<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;00FF00&#39;</span><span class="token punctuation">)</span>
ws<span class="token punctuation">[</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>font <span class="token operator">=</span> boldRedFont
ws<span class="token punctuation">[</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;Bold 00FF00 Times New Roman&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>公式</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>ws1 <span class="token operator">=</span> wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">&#39;Formula&#39;</span><span class="token punctuation">)</span>
ws1<span class="token punctuation">[</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">200</span>
ws1<span class="token punctuation">[</span><span class="token string">&#39;A2&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">300</span>
ws1<span class="token punctuation">[</span><span class="token string">&#39;A3&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;=SUM(A1:A2)&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>行高和列宽</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>ws2 <span class="token operator">=</span> wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">&#39;Dimensions&#39;</span><span class="token punctuation">)</span>
ws2<span class="token punctuation">[</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;Tall Row&#39;</span>
ws2<span class="token punctuation">.</span>row_dimensions<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">20</span>
ws2<span class="token punctuation">[</span><span class="token string">&#39;B2&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;Wide Column&#39;</span>
ws2<span class="token punctuation">.</span>column_dimensions<span class="token punctuation">[</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">70</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>单元格合并</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>ws3 <span class="token operator">=</span> wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">&#39;Merging&#39;</span><span class="token punctuation">)</span>
ws3<span class="token punctuation">.</span>merge_cells<span class="token punctuation">(</span><span class="token string">&#39;A1:D3&#39;</span><span class="token punctuation">)</span>
ws3<span class="token punctuation">[</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;Twelve cells merged together&#39;</span>
ws3<span class="token punctuation">.</span>merge_cells<span class="token punctuation">(</span><span class="token string">&#39;C5:D5&#39;</span><span class="token punctuation">)</span>
ws3<span class="token punctuation">[</span><span class="token string">&#39;C5&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;Two merged cells&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>单元格拆分</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>ws4 <span class="token operator">=</span> wb<span class="token punctuation">.</span>copy_worksheet<span class="token punctuation">(</span>wb<span class="token punctuation">[</span><span class="token string">&#39;Merging&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ws4<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;Unmerging&#39;</span>
ws4<span class="token punctuation">.</span>unmerge_cells<span class="token punctuation">(</span><span class="token string">&#39;A1:D3&#39;</span><span class="token punctuation">)</span>
ws4<span class="token punctuation">.</span>unmerge_cells<span class="token punctuation">(</span><span class="token string">&#39;C5:D5&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="excel图表" tabindex="-1"><a class="header-anchor" href="#excel图表" aria-hidden="true">#</a> Excel图表</h2><ul><li><p><strong>饼状图</strong></p><p>参考文档：https://openpyxl.readthedocs.io/en/stable/charts/pie.html</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> openpyxl
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>chart <span class="token keyword">import</span> Reference<span class="token punctuation">,</span> PieChart

wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>active

data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&#39;Pie&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Sold&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">&#39;Apple&#39;</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">&#39;Cherry&#39;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">&#39;Pumpkin&#39;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">&#39;Chocolate&#39;</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    ws<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>

pie <span class="token operator">=</span> PieChart<span class="token punctuation">(</span><span class="token punctuation">)</span>
cates <span class="token operator">=</span> Reference<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> min_col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> min_row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> Reference<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> min_col<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> min_row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
pie<span class="token punctuation">.</span>add_data<span class="token punctuation">(</span>data<span class="token punctuation">,</span> titles_from_data<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
pie<span class="token punctuation">.</span>set_categories<span class="token punctuation">(</span>cates<span class="token punctuation">)</span>
pie<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;Pies sold by category&#39;</span>
ws<span class="token punctuation">.</span>add_chart<span class="token punctuation">(</span>pie<span class="token punctuation">,</span> <span class="token string">&#39;D1&#39;</span><span class="token punctuation">)</span>

wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;pie.xlsx&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>条形图</strong></p><p>参考文档：https://openpyxl.readthedocs.io/en/stable/charts/bar.html</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> openpyxl
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>chart <span class="token keyword">import</span> Reference<span class="token punctuation">,</span> BarChart

wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">&#39;BarChart&#39;</span><span class="token punctuation">)</span>

rows <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">(</span><span class="token string">&#39;Number&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Batch 1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Batch 2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> rows<span class="token punctuation">:</span>
    ws<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>

bar <span class="token operator">=</span> BarChart<span class="token punctuation">(</span><span class="token punctuation">)</span>
bar<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">=</span> <span class="token string">&#39;col&#39;</span>
bar<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token number">15</span>
bar<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;Bar Chart&#39;</span>
bar<span class="token punctuation">.</span>y_axis<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;Sample length(mm)&#39;</span>
bar<span class="token punctuation">.</span>x_axis<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;Test number&#39;</span>

cates <span class="token operator">=</span> Reference<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> min_col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> min_row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> Reference<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> min_col<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> max_col<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> min_row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span>
bar<span class="token punctuation">.</span>add_data<span class="token punctuation">(</span>data<span class="token punctuation">,</span> titles_from_data<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
bar<span class="token punctuation">.</span>set_categories<span class="token punctuation">(</span>cates<span class="token punctuation">)</span>
ws<span class="token punctuation">.</span>add_chart<span class="token punctuation">(</span>bar<span class="token punctuation">,</span> <span class="token string">&#39;E1&#39;</span><span class="token punctuation">)</span>

wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;bar.xlsx&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>气泡图</strong></p><p>参考文档：https://openpyxl.readthedocs.io/en/stable/charts/bubble.html</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> openpyxl
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>chart <span class="token keyword">import</span> Reference<span class="token punctuation">,</span> Series<span class="token punctuation">,</span> BubbleChart

wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">&#39;BubbleCharts&#39;</span><span class="token punctuation">)</span>

rows <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">(</span><span class="token string">&quot;Number of Products&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Sales in USD&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Market share&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">12200</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">60000</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">24400</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">32000</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">8200</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">50000</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">22400</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">25000</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> rows<span class="token punctuation">:</span>
    ws<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>

bubble <span class="token operator">=</span> BubbleChart<span class="token punctuation">(</span><span class="token punctuation">)</span>
bubble<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token number">18</span>
bubble<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;Bubble Chart&#39;</span>

x_value <span class="token operator">=</span> Reference<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> min_col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> min_row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
y_value <span class="token operator">=</span> Reference<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> min_col<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> min_row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
size <span class="token operator">=</span> Reference<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> min_col<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> min_row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
series <span class="token operator">=</span> Series<span class="token punctuation">(</span>values<span class="token operator">=</span>y_value<span class="token punctuation">,</span> xvalues<span class="token operator">=</span>x_value<span class="token punctuation">,</span> zvalues<span class="token operator">=</span>size<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token number">2013</span><span class="token punctuation">)</span>
bubble<span class="token punctuation">.</span>series<span class="token punctuation">.</span>append<span class="token punctuation">(</span>series<span class="token punctuation">)</span>

x_value <span class="token operator">=</span> Reference<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> min_col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> min_row<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
y_value <span class="token operator">=</span> Reference<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> min_col<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> min_row<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
size <span class="token operator">=</span> Reference<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> min_col<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> min_row<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
series <span class="token operator">=</span> Series<span class="token punctuation">(</span>values<span class="token operator">=</span>y_value<span class="token punctuation">,</span> xvalues<span class="token operator">=</span>x_value<span class="token punctuation">,</span> zvalues<span class="token operator">=</span>size<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token number">2014</span><span class="token punctuation">)</span>
bubble<span class="token punctuation">.</span>series<span class="token punctuation">.</span>append<span class="token punctuation">(</span>series<span class="token punctuation">)</span>
ws<span class="token punctuation">.</span>add_chart<span class="token punctuation">(</span>bubble<span class="token punctuation">,</span> <span class="token string">&#39;E1&#39;</span><span class="token punctuation">)</span>

wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;bubble.xlsx&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul>`,18),o=[e];function c(l,i){return s(),a("div",null,o)}const k=n(t,[["render",c],["__file","03_Excel操作.html.vue"]]);export{k as default};
