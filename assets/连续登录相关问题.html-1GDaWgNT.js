import{_ as t}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as p,o as e,c as o,a as c,b as n,d as s,e as l,f as i}from"./app-VKLC1A-x.js";const u={},k=n("p",null,"连续登录及相关变形 SQL 练习题，包括连续登录、最后连续登录、连续未登录等问题",-1),d=n("h1",{id:"连续登录相关问题",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#连续登录相关问题","aria-hidden":"true"},"#"),s(" 连续登录相关问题")],-1),r={href:"https://blog.csdn.net/helloxiaozhe/article/details/116151617",target:"_blank",rel:"noopener noreferrer"},v=i(`<h2 id="数据准备" tabindex="-1"><a class="header-anchor" href="#数据准备" aria-hidden="true">#</a> 数据准备</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_active
<span class="token punctuation">(</span>
  name         <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  install_date <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  active_date  <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> user_active <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-02&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-03&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-04&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-08&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-09&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-10&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-11&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-17&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-18&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-19&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-22&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;李四&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;李四&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-02&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;李四&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-15&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;李四&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-16&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;李四&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-17&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;李四&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-18&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;李四&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-19&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">&#39;王五&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-03&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-01-12&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="最大连续登录天数" tabindex="-1"><a class="header-anchor" href="#最大连续登录天数" aria-hidden="true">#</a> 最大连续登录天数</h2><ul><li><strong>方案一</strong>：</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>name            <span class="token keyword">AS</span> name
      <span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>activedays<span class="token punctuation">)</span> <span class="token keyword">AS</span> 最大连续登录天数
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>name  <span class="token keyword">AS</span> name
            <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> activedays
      <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> name
                  <span class="token punctuation">,</span>active_date
                  <span class="token punctuation">,</span>ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> active_date<span class="token punctuation">)</span>                                     <span class="token keyword">AS</span> rn
                  <span class="token punctuation">,</span>DATE_SUB<span class="token punctuation">(</span>active_date<span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> active_date<span class="token punctuation">)</span> <span class="token keyword">DAY</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> date_rn
            <span class="token keyword">FROM</span> user_active
      <span class="token punctuation">)</span> t1
      <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>date_rn
<span class="token punctuation">)</span> t2
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>name
<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>方案二</strong>：</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>name
      <span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>activedays<span class="token punctuation">)</span> <span class="token keyword">AS</span> 最大连续登录天数
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>name
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>diff <span class="token operator">-</span> CAST<span class="token punctuation">(</span>t1<span class="token punctuation">.</span>rn <span class="token keyword">AS</span> SIGNED<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token keyword">value</span>
            <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                        <span class="token keyword">AS</span> activedays
      <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> name
                  <span class="token punctuation">,</span>active_date
                  <span class="token punctuation">,</span>ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> active_date<span class="token punctuation">)</span> <span class="token keyword">AS</span> rn
                  <span class="token punctuation">,</span>DATEDIFF<span class="token punctuation">(</span>active_date<span class="token punctuation">,</span> install_date<span class="token punctuation">)</span>                        <span class="token keyword">AS</span> diff
            <span class="token keyword">FROM</span> user_active
      <span class="token punctuation">)</span> t1
      <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>diff <span class="token operator">-</span> CAST<span class="token punctuation">(</span>t1<span class="token punctuation">.</span>rn <span class="token keyword">AS</span> SIGNED<span class="token punctuation">)</span>
<span class="token punctuation">)</span> t2
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>name
<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="最后登录时连续登录天数" tabindex="-1"><a class="header-anchor" href="#最后登录时连续登录天数" aria-hidden="true">#</a> 最后登录时连续登录天数</h2><blockquote><p>获取用户最后一次登录时连续登录的天数</p></blockquote><ul><li><strong>方案一</strong>：</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>name       <span class="token keyword">AS</span> name
      <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>activedays <span class="token keyword">AS</span> 最后连续登录天数
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>name <span class="token keyword">AS</span> name
            <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>date_rn<span class="token punctuation">)</span>                      <span class="token keyword">AS</span> activedays
            <span class="token punctuation">,</span>ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>active_date <span class="token keyword">DESC</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> date_desc_rn
      <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> name
                  <span class="token punctuation">,</span>active_date
                  <span class="token punctuation">,</span>ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> active_date<span class="token punctuation">)</span>                                     <span class="token keyword">AS</span> rn
                  <span class="token punctuation">,</span>DATE_SUB<span class="token punctuation">(</span>active_date<span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> active_date<span class="token punctuation">)</span> <span class="token keyword">DAY</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> date_rn
            <span class="token keyword">FROM</span> user_active
      <span class="token punctuation">)</span> t1
<span class="token punctuation">)</span> t2
<span class="token keyword">WHERE</span> t2<span class="token punctuation">.</span>date_desc_rn <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>方案二</strong>：</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">WITH</span> active <span class="token keyword">AS</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> t<span class="token punctuation">.</span>name
          <span class="token punctuation">,</span>t<span class="token punctuation">.</span>active_date
          <span class="token punctuation">,</span>t<span class="token punctuation">.</span>rn
          <span class="token punctuation">,</span>t<span class="token punctuation">.</span>diff
          <span class="token punctuation">,</span>t<span class="token punctuation">.</span>diff <span class="token operator">-</span> CAST<span class="token punctuation">(</span>t<span class="token punctuation">.</span>rn <span class="token keyword">AS</span> SIGNED<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token keyword">value</span>
    <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
          <span class="token keyword">SELECT</span> name
                <span class="token punctuation">,</span>active_date
                <span class="token punctuation">,</span>ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> active_date<span class="token punctuation">)</span> <span class="token keyword">AS</span> rn
                <span class="token punctuation">,</span>DATEDIFF<span class="token punctuation">(</span>active_date<span class="token punctuation">,</span> install_date<span class="token punctuation">)</span>                        <span class="token keyword">AS</span> diff
          <span class="token keyword">FROM</span> user_active
    <span class="token punctuation">)</span> t
<span class="token punctuation">)</span>

<span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>name
      <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 最后连续登录天数
<span class="token keyword">FROM</span> active t1
<span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span> name
            <span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> lastactive
      <span class="token keyword">FROM</span> active
      <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> name
     <span class="token punctuation">)</span> t2
  <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>name  <span class="token operator">=</span> t2<span class="token punctuation">.</span>name
 <span class="token operator">AND</span> t1<span class="token punctuation">.</span><span class="token keyword">value</span> <span class="token operator">=</span> t2<span class="token punctuation">.</span>lastactive
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>name
<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="最后连续登录时连续登录天数" tabindex="-1"><a class="header-anchor" href="#最后连续登录时连续登录天数" aria-hidden="true">#</a> 最后连续登录时连续登录天数</h2><blockquote><p>获取用户最后一次存在连续登录行为时，连续登录的天数</p></blockquote><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> t3<span class="token punctuation">.</span>name
      <span class="token punctuation">,</span>t3<span class="token punctuation">.</span>activedays <span class="token keyword">AS</span> 最后连续登录时连续登录的天数
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>name       <span class="token keyword">AS</span> name
            <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>activedays <span class="token keyword">AS</span> activedays
            <span class="token punctuation">,</span>ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>active_date <span class="token keyword">DESC</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> rn
      <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>name <span class="token keyword">AS</span> name
                  <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>date_rn<span class="token punctuation">)</span> <span class="token keyword">AS</span> activedays
                  <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>active_date                                   <span class="token keyword">AS</span> active_date
            <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
                  <span class="token keyword">SELECT</span> name
                        <span class="token punctuation">,</span>active_date
                        <span class="token punctuation">,</span>ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> active_date<span class="token punctuation">)</span>                                     <span class="token keyword">AS</span> rn
                        <span class="token punctuation">,</span>DATE_SUB<span class="token punctuation">(</span>active_date<span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> active_date<span class="token punctuation">)</span> <span class="token keyword">DAY</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> date_rn
                  <span class="token keyword">FROM</span> user_active
            <span class="token punctuation">)</span> t1
      <span class="token punctuation">)</span> t2
      <span class="token keyword">WHERE</span> t2<span class="token punctuation">.</span>activedays <span class="token operator">&gt;</span> <span class="token number">1</span>
<span class="token punctuation">)</span> t3
<span class="token keyword">WHERE</span> t3<span class="token punctuation">.</span>rn <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="最大连续未登录天数" tabindex="-1"><a class="header-anchor" href="#最大连续未登录天数" aria-hidden="true">#</a> 最大连续未登录天数</h2><ul><li><strong>方案一</strong>：</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> t3<span class="token punctuation">.</span>name
      <span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>DATEDIFF<span class="token punctuation">(</span>t3<span class="token punctuation">.</span>next_date<span class="token punctuation">,</span> t3<span class="token punctuation">.</span>date_rn<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 最大连续未登录天数
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>name
            <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>date_rn
            <span class="token punctuation">,</span>LEAD<span class="token punctuation">(</span>t2<span class="token punctuation">.</span>date_rn<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>date_rn<span class="token punctuation">)</span> <span class="token keyword">AS</span> next_date
      <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>name
                  <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>date_rn
            <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
                  <span class="token keyword">SELECT</span> name
                        <span class="token punctuation">,</span>active_date
                        <span class="token punctuation">,</span>ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> active_date<span class="token punctuation">)</span>                                     <span class="token keyword">AS</span> rn
                        <span class="token punctuation">,</span>DATE_SUB<span class="token punctuation">(</span>active_date<span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> active_date<span class="token punctuation">)</span> <span class="token keyword">DAY</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> date_rn
                  <span class="token keyword">FROM</span> user_active
            <span class="token punctuation">)</span> t1
            <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>date_rn
      <span class="token punctuation">)</span> t2
<span class="token punctuation">)</span> t3
<span class="token keyword">WHERE</span> t3<span class="token punctuation">.</span>next_date <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t3<span class="token punctuation">.</span>name
<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>方案二</strong>：</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">WITH</span> active <span class="token keyword">AS</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> t<span class="token punctuation">.</span>name
          <span class="token punctuation">,</span>t<span class="token punctuation">.</span>active_date
          <span class="token punctuation">,</span>t<span class="token punctuation">.</span>rn
          <span class="token punctuation">,</span>t<span class="token punctuation">.</span>diff
          <span class="token punctuation">,</span>t<span class="token punctuation">.</span>diff <span class="token operator">-</span> CAST<span class="token punctuation">(</span>t<span class="token punctuation">.</span>rn <span class="token keyword">AS</span> SIGNED<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token keyword">value</span>
    <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
          <span class="token keyword">SELECT</span> name
                <span class="token punctuation">,</span>active_date
                <span class="token punctuation">,</span>ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> active_date<span class="token punctuation">)</span> <span class="token keyword">AS</span> rn
                <span class="token punctuation">,</span>DATEDIFF<span class="token punctuation">(</span>active_date<span class="token punctuation">,</span> install_date<span class="token punctuation">)</span>                        <span class="token keyword">AS</span> diff
          <span class="token keyword">FROM</span> user_active
    <span class="token punctuation">)</span> t
<span class="token punctuation">)</span>

<span class="token keyword">SELECT</span> t3<span class="token punctuation">.</span>name
      <span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>noactivedays<span class="token punctuation">)</span>  <span class="token keyword">AS</span> 最大连续未登录天数
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>name
        <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>active_date      <span class="token keyword">AS</span> start_date
        <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>active_date      <span class="token keyword">AS</span> end_date
        <span class="token punctuation">,</span>t2<span class="token punctuation">.</span><span class="token keyword">value</span> <span class="token operator">-</span> t1<span class="token punctuation">.</span><span class="token keyword">value</span> <span class="token keyword">AS</span> noactivedays
  <span class="token keyword">FROM</span> active <span class="token keyword">AS</span> t1
  <span class="token keyword">JOIN</span> active <span class="token keyword">AS</span> t2
    <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>name <span class="token operator">=</span> t2<span class="token punctuation">.</span>name
   <span class="token operator">AND</span> t1<span class="token punctuation">.</span>rn   <span class="token operator">=</span> t2<span class="token punctuation">.</span>rn <span class="token operator">-</span> <span class="token number">1</span>

  <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>

  <span class="token keyword">SELECT</span> name
        <span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>active_date<span class="token punctuation">)</span>                         <span class="token keyword">AS</span> start_date
        <span class="token punctuation">,</span><span class="token string">&#39;2021-01-23&#39;</span>                             <span class="token keyword">AS</span> end_date
        <span class="token punctuation">,</span>DATEDIFF<span class="token punctuation">(</span><span class="token string">&#39;2021-01-23&#39;</span><span class="token punctuation">,</span> <span class="token function">MAX</span><span class="token punctuation">(</span>active_date<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> noactivedays
  <span class="token keyword">FROM</span> user_active
  <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> name
<span class="token punctuation">)</span> t3
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t3<span class="token punctuation">.</span>name
<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="连续未登录天数历史" tabindex="-1"><a class="header-anchor" href="#连续未登录天数历史" aria-hidden="true">#</a> 连续未登录天数历史</h2><blockquote><p>用户自从安装 app 以来的连续未登录天数历史</p></blockquote><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">with</span> active <span class="token keyword">AS</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> t<span class="token punctuation">.</span>name
          <span class="token punctuation">,</span>t<span class="token punctuation">.</span>active_date
          <span class="token punctuation">,</span>t<span class="token punctuation">.</span>rn
          <span class="token punctuation">,</span>t<span class="token punctuation">.</span>diff
          <span class="token punctuation">,</span>t<span class="token punctuation">.</span>diff <span class="token operator">-</span> CAST<span class="token punctuation">(</span>t<span class="token punctuation">.</span>rn <span class="token keyword">AS</span> SIGNED<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token keyword">value</span>
    <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
          <span class="token keyword">SELECT</span> name
                <span class="token punctuation">,</span>active_date
                <span class="token punctuation">,</span>ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> active_date<span class="token punctuation">)</span> <span class="token keyword">AS</span> rn
                <span class="token punctuation">,</span>DATEDIFF<span class="token punctuation">(</span>active_date<span class="token punctuation">,</span> install_date<span class="token punctuation">)</span>                        <span class="token keyword">AS</span> diff
          <span class="token keyword">FROM</span> user_active
    <span class="token punctuation">)</span> t
<span class="token punctuation">)</span>

<span class="token keyword">SELECT</span> t3<span class="token punctuation">.</span>name
      <span class="token punctuation">,</span>t3<span class="token punctuation">.</span>start_date
      <span class="token punctuation">,</span>t3<span class="token punctuation">.</span>end_date
      <span class="token punctuation">,</span>t3<span class="token punctuation">.</span>noactivedays <span class="token keyword">AS</span> 连续未登录天数
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>name
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>active_date      <span class="token keyword">AS</span> start_date
            <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>active_date      <span class="token keyword">AS</span> end_date
            <span class="token punctuation">,</span>t2<span class="token punctuation">.</span><span class="token keyword">value</span> <span class="token operator">-</span> t1<span class="token punctuation">.</span><span class="token keyword">value</span> <span class="token keyword">AS</span> noactivedays
      <span class="token keyword">FROM</span> active <span class="token keyword">AS</span> t1
      <span class="token keyword">JOIN</span> active <span class="token keyword">AS</span> t2
        <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>name <span class="token operator">=</span> t2<span class="token punctuation">.</span>name
       <span class="token operator">AND</span> t1<span class="token punctuation">.</span>rn   <span class="token operator">=</span> t2<span class="token punctuation">.</span>rn <span class="token operator">-</span> <span class="token number">1</span>

      <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>

      <span class="token keyword">SELECT</span> name
            <span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>active_date<span class="token punctuation">)</span>                         <span class="token keyword">AS</span> start_date
            <span class="token punctuation">,</span><span class="token string">&#39;2021-01-23&#39;</span>                             <span class="token keyword">AS</span> end_date
            <span class="token punctuation">,</span>DATEDIFF<span class="token punctuation">(</span><span class="token string">&#39;2021-01-23&#39;</span><span class="token punctuation">,</span> <span class="token function">MAX</span><span class="token punctuation">(</span>active_date<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> noactivedays
      <span class="token keyword">FROM</span> user_active
      <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> name
<span class="token punctuation">)</span> t3
<span class="token keyword">WHERE</span> t3<span class="token punctuation">.</span>noactivedays <span class="token operator">&gt;</span> <span class="token number">0</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t3<span class="token punctuation">.</span>name
<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="连续登录-3-天用户" tabindex="-1"><a class="header-anchor" href="#连续登录-3-天用户" aria-hidden="true">#</a> 连续登录 3 天用户</h2><blockquote><p>存在连续登录 3 天及以上行为的用户</p></blockquote><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> t1<span class="token punctuation">.</span>name  <span class="token keyword">AS</span> name
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span> name
            <span class="token punctuation">,</span>active_date
            <span class="token punctuation">,</span>ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> active_date<span class="token punctuation">)</span>                                     <span class="token keyword">AS</span> rn
            <span class="token punctuation">,</span>DATE_SUB<span class="token punctuation">(</span>active_date<span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> active_date<span class="token punctuation">)</span> <span class="token keyword">DAY</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> date_rn
      <span class="token keyword">FROM</span> user_active
<span class="token punctuation">)</span> t1
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>date_rn
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">3</span>
<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="空闲且连续的座位编号" tabindex="-1"><a class="header-anchor" href="#空闲且连续的座位编号" aria-hidden="true">#</a> 空闲且连续的座位编号</h2><blockquote><p>有一张座位情况表（seat_tbl），包含字段座位编号（seat_id）、座位状态（isfree，1 表示空闲，0 表示非空闲）。要求获取处于空闲状态且编号是连续的座位编号</p></blockquote><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 数据准备</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> seat_tbl
<span class="token punctuation">(</span>
  seat_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
  isfree  <span class="token keyword">INT</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> seat_tbl <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">;</span>

<span class="token comment">-- 解决方案</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> a<span class="token punctuation">.</span>seat_id
<span class="token keyword">FROM</span> seat_tbl <span class="token keyword">AS</span> a
<span class="token keyword">JOIN</span> seat_tbl <span class="token keyword">AS</span> b
  <span class="token keyword">ON</span> ABS<span class="token punctuation">(</span>a<span class="token punctuation">.</span>seat_id <span class="token operator">-</span> b<span class="token punctuation">.</span>seat_id<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
 <span class="token operator">AND</span> a<span class="token punctuation">.</span>isfree <span class="token operator">=</span> <span class="token number">1</span>
 <span class="token operator">AND</span> b<span class="token punctuation">.</span>isfree <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> a<span class="token punctuation">.</span>seat_id
<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,30);function m(b,y){const a=p("ExternalLinkIcon");return e(),o("div",null,[k,c(" more "),d,n("p",null,[s("参考资料："),n("a",r,[s("SparkSQL—最大连续登录天数、当前连续登录天数、最大连续未登录天数问题"),l(a)])]),v])}const E=t(u,[["render",m],["__file","连续登录相关问题.html.vue"]]);export{E as default};
