import{_ as n}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as s,c as a,f as p}from"./app-VKLC1A-x.js";const t={},e=p(`<h1 id="操作word文档" tabindex="-1"><a class="header-anchor" href="#操作word文档" aria-hidden="true">#</a> 操作Word文档</h1><p>安装Python包：<code>pip install python-docx</code></p><p>文档链接：https://www.osgeo.cn/python-docx/</p><p>名词解释：</p><p><code>document</code>：整个文档</p><p><code>paragraph</code>：文档中的段落</p><p><code>run</code>：段落中的字符</p><h2 id="常用操作" tabindex="-1"><a class="header-anchor" href="#常用操作" aria-hidden="true">#</a> 常用操作</h2><ul><li><p><strong>打开文档和添加段落</strong></p><p>使用<code>docx.Document()</code>可以打开一个新文档</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> docx

document <span class="token operator">=</span> docx<span class="token punctuation">.</span>Document<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 创建一个新文档</span>
<span class="token comment"># 在文档中添加段落，第一个参数是段落的内容，第二个参数是段落的样式style</span>
paragraph <span class="token operator">=</span> document<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token string">&#39;作者：苏轼&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Subtitle&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 在段落paragraph前面插入一个段落，样式style为Title</span>
prior_paragraph <span class="token operator">=</span> paragraph<span class="token punctuation">.</span>insert_paragraph_before<span class="token punctuation">(</span><span class="token string">&#39;水调歌头&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Title&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 在文档中添加标题heading，level指定标题等级，默认为一级</span>
document<span class="token punctuation">.</span>add_heading<span class="token punctuation">(</span><span class="token string">&#39;Heading 0&#39;</span><span class="token punctuation">,</span> level<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;test_水调歌头.docx&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 保存文档文件，参数为文件名</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>段落样式</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>paragraph2 <span class="token operator">=</span> document<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token string">&#39;流金岁月&#39;</span><span class="token punctuation">)</span>
paragraph2<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token string">&#39;List Bullet 2&#39;</span>  <span class="token comment"># 无序列表</span>
paragraph3 <span class="token operator">=</span> document<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token string">&#39;似水流年&#39;</span><span class="token punctuation">)</span>
paragraph3<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token string">&#39;List Number 2&#39;</span>  <span class="token comment"># 有序列表</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>字符样式</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> docx<span class="token punctuation">.</span>shared <span class="token keyword">import</span> Pt

paragraph4 <span class="token operator">=</span> document<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token punctuation">)</span>
paragraph4<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token string">&#39;第一部分字符，&#39;</span><span class="token punctuation">)</span>
paragraph4<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token string">&#39;第二部分字符，&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bold <span class="token operator">=</span> <span class="token boolean">True</span>  <span class="token comment"># 加粗</span>
paragraph4<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token string">&#39;第三部分字符，&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Intense Emphasis&#39;</span><span class="token punctuation">)</span>
run <span class="token operator">=</span> paragraph4<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token string">&#39;the forth characters&#39;</span><span class="token punctuation">)</span>
run<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token string">&#39;Quote Char&#39;</span>  <span class="token comment"># 设置style</span>
run<span class="token punctuation">.</span>font<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;Sana&#39;</span>  <span class="token comment"># 设置字体</span>
run<span class="token punctuation">.</span>font<span class="token punctuation">.</span>size <span class="token operator">=</span> Pt<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>  <span class="token comment"># 设置字体大小</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>添加分页</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>document<span class="token punctuation">.</span>add_page_break<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><strong>添加表格</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># 添加一个5行8列，style为Colorful Shading的表格</span>
table <span class="token operator">=</span> document<span class="token punctuation">.</span>add_table<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> cols<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> style<span class="token operator">=</span><span class="token string">&#39;Colorful Shading&#39;</span><span class="token punctuation">)</span>
cell_1 <span class="token operator">=</span> table<span class="token punctuation">.</span>cell<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 获取表格中的单元格，行列都是从0开始</span>
cell_2 <span class="token operator">=</span> table<span class="token punctuation">.</span>cell<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
cell_1<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>cell_2<span class="token punctuation">)</span>  <span class="token comment"># 合并单元格</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>表格操作</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> docx<span class="token punctuation">.</span>shared <span class="token keyword">import</span> Cm

table <span class="token operator">=</span> document<span class="token punctuation">.</span>tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 获取文档中的第一个表格</span>
<span class="token keyword">for</span> row<span class="token punctuation">,</span> rowObj <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span>rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> col<span class="token punctuation">,</span> cell <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>rowObj<span class="token punctuation">.</span>cells<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cell<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">&#39;{}, {}&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span>  <span class="token comment"># 向单元格中写入内容</span>
table<span class="token punctuation">.</span>columns<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>width <span class="token operator">=</span> Cm<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment"># 设置第五列的宽度</span>
table<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token string">&#39;Light Grid&#39;</span>  <span class="token comment"># 设置表格的样式</span>
row <span class="token operator">=</span> table<span class="token punctuation">.</span>rows<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>  <span class="token comment"># 获取表格的第四行</span>
row<span class="token punctuation">.</span>cells<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">&#39;elephant&#39;</span>  <span class="token comment"># 更改单元格中的内容</span>
row_count <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span>rows<span class="token punctuation">)</span>  <span class="token comment"># 获取表格的行数</span>
col_count <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>  <span class="token comment"># 获取表格的列数</span>
row <span class="token operator">=</span> table<span class="token punctuation">.</span>add_row<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 给表格新增一行</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>调整表格宽度</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> docx<span class="token punctuation">.</span>shared <span class="token keyword">import</span> Cm

table<span class="token punctuation">.</span>allow_autofit <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># 允许人工调节表格列宽</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> table<span class="token punctuation">.</span>rows<span class="token punctuation">:</span>
    row<span class="token punctuation">.</span>cells<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>width <span class="token operator">=</span> Cm<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>  <span class="token comment"># 设置表格每一列的宽度</span>
    row<span class="token punctuation">.</span>cells<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>width <span class="token operator">=</span> Cm<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>删除表格中的行</strong></p><p>给定Word中的表格对象和行对象，可以删除此行</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">remove_row</span><span class="token punctuation">(</span>table<span class="token punctuation">,</span> row<span class="token punctuation">)</span><span class="token punctuation">:</span>
    tbl <span class="token operator">=</span> table<span class="token punctuation">.</span>_tbl
    tr <span class="token operator">=</span> row<span class="token punctuation">.</span>_tr
    tbl<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>tr<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>添加图片</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>document<span class="token punctuation">.</span>add_picture<span class="token punctuation">(</span><span class="token string">&#39;sheep.jpg&#39;</span><span class="token punctuation">,</span> width<span class="token operator">=</span>Cm<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 添加图片，宽度为5cm</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><strong>设置中文字体</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">set_Chinese_font</span><span class="token punctuation">(</span>run<span class="token punctuation">,</span> font<span class="token punctuation">)</span><span class="token punctuation">:</span>
    run<span class="token punctuation">.</span>font<span class="token punctuation">.</span>name <span class="token operator">=</span> font
    r <span class="token operator">=</span> run<span class="token punctuation">.</span>_element
    r<span class="token punctuation">.</span>rPr<span class="token punctuation">.</span>rFonts<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>qn<span class="token punctuation">(</span><span class="token string">&#39;w:eastAsia&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> font<span class="token punctuation">)</span>

<span class="token keyword">for</span> paragraph <span class="token keyword">in</span> document<span class="token punctuation">.</span>paragraphs<span class="token punctuation">:</span>  <span class="token comment"># 设置段落中的中文字体</span>
    <span class="token keyword">for</span> run <span class="token keyword">in</span> paragraph<span class="token punctuation">.</span>runs<span class="token punctuation">:</span>
        set_Chinese_font<span class="token punctuation">(</span>run<span class="token punctuation">,</span> <span class="token string">&#39;Kaiti&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> row <span class="token keyword">in</span> table<span class="token punctuation">.</span>rows<span class="token punctuation">:</span>  <span class="token comment"># 设置表格中的中文字体</span>
    <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">.</span>cells<span class="token punctuation">:</span>
        <span class="token keyword">for</span> paragraph <span class="token keyword">in</span> cell<span class="token punctuation">.</span>paragraphs<span class="token punctuation">:</span>
            <span class="token keyword">for</span> run <span class="token keyword">in</span> paragraph<span class="token punctuation">.</span>runs<span class="token punctuation">:</span>
                set_Chinese_font<span class="token punctuation">(</span>run<span class="token punctuation">,</span> <span class="token string">&#39;Kaiti&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul>`,9),o=[e];function c(l,i){return s(),a("div",null,o)}const d=n(t,[["render",c],["__file","02_操作Word文档.html.vue"]]);export{d as default};
