import{_ as n}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as s,c as a,f as p}from"./app-VKLC1A-x.js";const t={},e=p(`<h1 id="存储过程" tabindex="-1"><a class="header-anchor" href="#存储过程" aria-hidden="true">#</a> 存储过程</h1><h2 id="存储过程-1" tabindex="-1"><a class="header-anchor" href="#存储过程-1" aria-hidden="true">#</a> 存储过程</h2><h3 id="创建存储过程" tabindex="-1"><a class="header-anchor" href="#创建存储过程" aria-hidden="true">#</a> 创建存储过程</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 语法结构</span>
<span class="token comment">-- IN 表示入参，OUT 表示出参。不写默认为 IN 入参</span>
<span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">PROCEDURE</span> 存储过程名<span class="token punctuation">(</span>  <span class="token comment">-- 参数的数据类型不能带长度</span>
                                      参数<span class="token number">1</span> <span class="token punctuation">[</span><span class="token operator">IN</span><span class="token operator">|</span><span class="token keyword">OUT</span><span class="token punctuation">]</span> 数据类型
                                     <span class="token punctuation">,</span>参数<span class="token number">2</span> <span class="token punctuation">[</span><span class="token operator">IN</span><span class="token operator">|</span><span class="token keyword">OUT</span><span class="token punctuation">]</span> 数据类型
                                     <span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
                                     <span class="token punctuation">)</span>
<span class="token operator">IS</span>  <span class="token comment">-- IS 或者 AS 随便写一个都可以</span>
  <span class="token comment">-- 声明变量</span>
<span class="token keyword">BEGIN</span>
  <span class="token comment">-- 执行逻辑</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>

<span class="token comment">-- 示例</span>
<span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">PROCEDURE</span> SP_GET_EMP<span class="token punctuation">(</span>
                                       P_EMPNO <span class="token operator">IN</span>  NUMBER
                                      <span class="token punctuation">,</span>O_ENAME <span class="token keyword">OUT</span> VARCHAR2
                                      <span class="token punctuation">,</span>O_SAL   <span class="token keyword">OUT</span> NUMBER
                                      <span class="token punctuation">,</span>O_HD    <span class="token keyword">OUT</span> <span class="token keyword">DATE</span>
                                      <span class="token punctuation">)</span>
<span class="token operator">IS</span>

<span class="token keyword">BEGIN</span>
  <span class="token keyword">SELECT</span> T<span class="token punctuation">.</span>ENAME<span class="token punctuation">,</span> T<span class="token punctuation">.</span>SAL<span class="token punctuation">,</span> T<span class="token punctuation">.</span>HIREDATE
  <span class="token comment">-- 出参和变量一样，是可以接收数据的，程序结束的时候会自动将值通过出参返回</span>
  <span class="token keyword">INTO</span> O_ENAME<span class="token punctuation">,</span> O_SAL<span class="token punctuation">,</span> O_HD
  <span class="token keyword">FROM</span> EMP T
  <span class="token keyword">WHERE</span> T<span class="token punctuation">.</span>EMPNO <span class="token operator">=</span> P_EMPNO<span class="token punctuation">;</span>
<span class="token keyword">END</span> SP_GET_EMP<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em><strong>注</strong></em>：存储过程和函数一样，都需要编译后才能使用，编译方法和检查方法也相同</p><h3 id="调用存储过程" tabindex="-1"><a class="header-anchor" href="#调用存储过程" aria-hidden="true">#</a> 调用存储过程</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 语法结构</span>
<span class="token keyword">DECLARE</span>
  <span class="token comment">-- 声明变量</span>
<span class="token keyword">BEGIN</span>
  存储过程名<span class="token punctuation">(</span>参数<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>

<span class="token comment">-- 示例</span>
<span class="token keyword">DECLARE</span>
  V_ENAME VARCHAR2<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  V_SAL   NUMBER<span class="token punctuation">;</span>
  V_HD    <span class="token keyword">DATE</span><span class="token punctuation">;</span>
<span class="token keyword">BEGIN</span>
  SP_GET_EMP<span class="token punctuation">(</span>
             P_EMPNO <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">7788</span>  <span class="token comment">-- 将 7369 传递给入参 P_EMPNO</span>
             <span class="token comment">-- 程序返回的姓名、工资、入职日期通过出参给到 V_ENAME、V_SAL、V_HD</span>
            <span class="token punctuation">,</span>O_ENAME <span class="token operator">=</span><span class="token operator">&gt;</span> V_ENAME
            <span class="token punctuation">,</span>O_SAL <span class="token operator">=</span><span class="token operator">&gt;</span> V_SAL
            <span class="token punctuation">,</span>O_HD <span class="token operator">=</span><span class="token operator">&gt;</span> V_HD
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">-- 验证变量里的值</span>
  DBMS_OUTPUT<span class="token punctuation">.</span>PUT_LINE<span class="token punctuation">(</span>V_ENAME<span class="token punctuation">)</span><span class="token punctuation">;</span>
  DBMS_OUTPUT<span class="token punctuation">.</span>PUT_LINE<span class="token punctuation">(</span>V_SAL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  DBMS_OUTPUT<span class="token punctuation">.</span>PUT_LINE<span class="token punctuation">(</span>V_HD<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="存储过程实现数据加工-案例" tabindex="-1"><a class="header-anchor" href="#存储过程实现数据加工-案例" aria-hidden="true">#</a> 存储过程实现数据加工（案例）</h2><blockquote><p>需求：开发一个存储过程，功能是传入一个学生编号，将这个学生的学号、姓名、选修课程数、平均分加工到表格 STU_DETAIL_0402 里面</p></blockquote><h3 id="数据准备" tabindex="-1"><a class="header-anchor" href="#数据准备" aria-hidden="true">#</a> 数据准备</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 创建 STUDENT 表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> STUDENT<span class="token punctuation">(</span>
                     SNO      VARCHAR2<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span> 
                     SNAME    VARCHAR2<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                     SAGE     NUMBER<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                     SSEX     VARCHAR2<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                     BIRTHDAY <span class="token keyword">DATE</span>
                    <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建 SC 表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> SC<span class="token punctuation">(</span>
                SNO   VARCHAR2<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                CNO   VARCHAR2<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                SCORE NUMBER<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
               <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/******* 初始化 STUDENT 表的数据 ******/</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENT <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s001&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;张芃&#39;</span><span class="token punctuation">,</span> FLOOR<span class="token punctuation">(</span>MONTHS_BETWEEN<span class="token punctuation">(</span>SYSDATE<span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2000-3-5&#39;</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2000-3-5&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENT <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s002&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;李蕤&#39;</span><span class="token punctuation">,</span> FLOOR<span class="token punctuation">(</span>MONTHS_BETWEEN<span class="token punctuation">(</span>SYSDATE<span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2001-2-3&#39;</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2001-2-3&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENT <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s003&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;吴筱莜&#39;</span><span class="token punctuation">,</span> FLOOR<span class="token punctuation">(</span>MONTHS_BETWEEN<span class="token punctuation">(</span>SYSDATE<span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2002-5-8&#39;</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2002-5-8&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENT <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s004&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;琴沁&#39;</span><span class="token punctuation">,</span> FLOOR<span class="token punctuation">(</span>MONTHS_BETWEEN<span class="token punctuation">(</span>SYSDATE<span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2000-6-15&#39;</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;女&#39;</span><span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2000-6-15&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENT <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s005&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;王郦珩&#39;</span><span class="token punctuation">,</span> FLOOR<span class="token punctuation">(</span>MONTHS_BETWEEN<span class="token punctuation">(</span>SYSDATE<span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2000-8-12&#39;</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;女&#39;</span><span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2000-8-12&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENT <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s006&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;李薄骞&#39;</span><span class="token punctuation">,</span> FLOOR<span class="token punctuation">(</span>MONTHS_BETWEEN<span class="token punctuation">(</span>SYSDATE<span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2001-9-20&#39;</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2001-9-20&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENT <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s007&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;刘昱音&#39;</span><span class="token punctuation">,</span> FLOOR<span class="token punctuation">(</span>MONTHS_BETWEEN<span class="token punctuation">(</span>SYSDATE<span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2002-10-5&#39;</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2002-10-5&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENT <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s008&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;萧戎翰&#39;</span><span class="token punctuation">,</span> FLOOR<span class="token punctuation">(</span>MONTHS_BETWEEN<span class="token punctuation">(</span>SYSDATE<span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2003-6-1&#39;</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;女&#39;</span><span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2003-6-1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENT <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s009&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;陈萧晓妍&#39;</span><span class="token punctuation">,</span> FLOOR<span class="token punctuation">(</span>MONTHS_BETWEEN<span class="token punctuation">(</span>SYSDATE<span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2001-1-15&#39;</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;女&#39;</span><span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2001-1-15&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENT <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s010&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;陈媺珈&#39;</span><span class="token punctuation">,</span> FLOOR<span class="token punctuation">(</span>MONTHS_BETWEEN<span class="token punctuation">(</span>SYSDATE<span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2001-1-9&#39;</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;女&#39;</span><span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">&#39;2001-1-9&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>

<span class="token comment">/******** 初始化 SC 表的数据 **********/</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s001&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c001&#39;</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s002&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c001&#39;</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s003&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c001&#39;</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s004&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c001&#39;</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s001&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c002&#39;</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s002&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c002&#39;</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s003&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c002&#39;</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s001&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c007&#39;</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s001&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c010&#39;</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s002&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c003&#39;</span><span class="token punctuation">,</span> <span class="token number">69</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s002&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c008&#39;</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s002&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c009&#39;</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s002&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c007&#39;</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s002&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c010&#39;</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s005&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c001&#39;</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s005&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c002&#39;</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s005&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c007&#39;</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s005&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c010&#39;</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s006&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c001&#39;</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s007&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c001&#39;</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s008&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c001&#39;</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s009&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c001&#39;</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s010&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c001&#39;</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s002&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c004&#39;</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s002&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c005&#39;</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;s002&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c006&#39;</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="使用存储过程加工数据" tabindex="-1"><a class="header-anchor" href="#使用存储过程加工数据" aria-hidden="true">#</a> 使用存储过程加工数据</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 需要提前创建 STU_DETAIL_0402 表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> STU_DETAIL_0402<span class="token punctuation">(</span>
                             SNO        VARCHAR2<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
                            <span class="token punctuation">,</span>SNAME      VARCHAR2<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
                            <span class="token punctuation">,</span>COUNT_CNO  NUMBER
                            <span class="token punctuation">,</span>AVG_COURSE NUMBER
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建存储过程</span>
<span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">PROCEDURE</span> SP_STU_DETAIL<span class="token punctuation">(</span>
                                          P_SNO <span class="token operator">IN</span> VARCHAR2
                                         <span class="token punctuation">)</span>
<span class="token operator">IS</span>

<span class="token keyword">BEGIN</span>
  <span class="token comment">-- 删除对应学生的数据</span>
  <span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> STU_DETAIL_0402 T
  <span class="token keyword">WHERE</span> T<span class="token punctuation">.</span>SNO <span class="token operator">=</span> P_SNO<span class="token punctuation">;</span>

  <span class="token comment">-- 将学生最新的数据插入到表中</span>
  <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STU_DETAIL_0402
  <span class="token keyword">SELECT</span> S<span class="token punctuation">.</span>SNO
        <span class="token punctuation">,</span>S<span class="token punctuation">.</span>SNAME
        <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>SC<span class="token punctuation">.</span>CNO<span class="token punctuation">)</span>
        <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>SC<span class="token punctuation">.</span>SCORE<span class="token punctuation">)</span>
  <span class="token keyword">FROM</span> STUDENT S
  <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> SC
         <span class="token keyword">ON</span> S<span class="token punctuation">.</span>SNO <span class="token operator">=</span> SC<span class="token punctuation">.</span>SNO
  <span class="token keyword">WHERE</span> S<span class="token punctuation">.</span>SNO <span class="token operator">=</span> P_SNO
  <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> S<span class="token punctuation">.</span>SNO<span class="token punctuation">,</span> S<span class="token punctuation">.</span>SNAME<span class="token punctuation">;</span>

  <span class="token keyword">COMMIT</span><span class="token punctuation">;</span>

  EXCEPTION <span class="token keyword">WHEN</span> OTHERS <span class="token keyword">THEN</span>
    <span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span>
    DBMS_OUTPUT<span class="token punctuation">.</span>put_line<span class="token punctuation">(</span>SQLERRM<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> SP_STU_DETAIL<span class="token punctuation">;</span>

<span class="token comment">-- 调用存储过程</span>
<span class="token keyword">DECLARE</span>
  V_SNO VARCHAR2<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">BEGIN</span>
  V_SNO :<span class="token operator">=</span> <span class="token operator">&amp;</span>INPUT_SNO<span class="token punctuation">;</span>
  SP_STU_DETAIL<span class="token punctuation">(</span>
                P_SNO <span class="token operator">=</span><span class="token operator">&gt;</span> V_SNO
               <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>

<span class="token comment">-- 查检结果</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> STU_DETAIL_0402<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,13),o=[e];function c(l,i){return s(),a("div",null,o)}const r=n(t,[["render",c],["__file","06_存储过程.html.vue"]]);export{r as default};
